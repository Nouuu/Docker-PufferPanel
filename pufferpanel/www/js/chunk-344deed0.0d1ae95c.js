(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-344deed0"],{"269a":function(e,t){e.exports=function(e,t){var a="function"===typeof e.exports?e.exports.extendOptions:e.options;for(var s in"function"===typeof e.exports&&(a.directives=e.exports.options.directives),a.directives=a.directives||{},t)a.directives[s]=a.directives[s]||t[s]}},"5bc3":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",{domProps:{textContent:e._s(e.$t("servers.Servers"))}}),a("v-row",[a("v-col",[a("v-sheet",{staticClass:"mb-8",attrs:{elevation:"1"}},[0===e.servers.length?a("div",{staticClass:"pt-2 text-center text--disabled",domProps:{textContent:e._s(e.$t("servers.NoServers"))}}):e._e(),a("v-list",{attrs:{"two-line":""}},e._l(e.servers,(function(t,s){return a("div",{key:t.id},[a("v-list-item",{attrs:{to:{name:"Server",params:{id:t.id}}}},[a("v-list-item-avatar",[t.online?a("v-icon",{attrs:{color:"success"}},[e._v(" mdi-check-circle ")]):a("v-icon",{attrs:{color:"error"}},[e._v(" mdi-alert-circle ")])],1),a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t.name)}}),a("v-list-item-subtitle",{domProps:{textContent:e._s(t.address+" @ "+t.node)}})],1)],1),s!==e.servers.length-1?a("v-divider"):e._e()],1)})),0),e.pagination.page<e.pagination.pageCount?a("v-row",{directives:[{name:"intersect",rawName:"v-intersect",value:e.lazyLoad,expression:"lazyLoad"}],ref:"lazy"},[a("v-col",{attrs:{cols:"2",offset:"5"}},[a("v-progress-circular",{staticClass:"mr-2",attrs:{indeterminate:""}}),a("span",{domProps:{textContent:e._s(e.$t("common.Loading"))}})],1)],1):e._e(),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.hasScope("servers.create")||e.isAdmin(),expression:"hasScope('servers.create') || isAdmin()"}],attrs:{color:"primary",bottom:"",right:"",fixed:"",fab:"",dark:"",large:"",to:{name:"AddServer"}}},[a("v-icon",[e._v("mdi-plus")])],1)],1)],1)],1)],1)},i=[],r=a("7c15"),n={data(){return{headers:[{text:this.$t("common.Name"),value:"name",sortable:!0},{text:this.$t("nodes.Node"),value:"node",sortable:!0},{text:this.$t("common.Address"),value:"address",sortable:!0},{text:this.$t("common.Online"),value:"online",sortable:!0}],servers:[],loading:!1,recheckLazy:!1,pagination:{page:0,rowsPerPage:10,pageCount:1},task:null}},watch:{recheckLazy(e){const t=this.$refs.lazy.getBoundingClientRect(),a=Math.max(document.documentElement.clientHeight,window.innerHeight);!(t.bottom<0||t.top-a>=0)&&this.pagination.page<this.pagination.pageCount&&this.loadNextPage()}},mounted(){this.task=setInterval(this.pollServerStatus,3e4)},beforeDestroy(){null!=this.task&&clearInterval(this.task)},methods:{lazyLoad(e,t,a){a&&this.loadNextPage()},loadNextPage(){if(this.loading)return;this.loading=!0;const e=this,{page:t,rowsPerPage:a}=this.pagination;this.$http.get("/api/servers",{params:{page:t+1,limit:a}}).then(a=>{for(const t in a.data.servers){const s=a.data.servers[t];let i=!1;if(e.servers.forEach(e=>{s.id===e.id&&(i=!0)}),!i){let t="";t=s.ip&&""!==s.ip&&"0.0.0.0"!==s.ip?s.ip:s.node.publicHost,s.port&&(t+=":"+s.port),e.servers.push({id:s.id,name:s.name,node:s.node.name,address:t,online:!1,nodeAddress:s.node.publicHost+":"+s.node.publicPort})}}e.pagination.page=t+1;const s=a.data.paging;e.pagination.pageCount=Math.ceil(s.total/e.pagination.rowsPerPage),e.loading=!1,e.recheckLazy=!0}).catch(Object(r["a"])(e)).finally(()=>{e.pollServerStatus()})},pollServerStatus(){for(const e in this.servers){const t=this.servers[e];this.$http.get("/proxy/daemon/server/"+t.id+"/status").then(e=>{e.data&&(e.data.running?t.online=!0:t.online=!1)})}},rowSelected(e){this.$router.push({name:"Server",params:{id:e.id}})},updatePage(e){this.pagination.page=e}}},o=n,d=a("2877"),l=a("6544"),c=a.n(l),p=a("8336"),v=a("62ad"),m=a("a523"),h=a("ce7e"),u=a("132d"),g=a("8860"),f=a("da13"),x=a("8270"),b=a("5d23"),w=a("490a"),C=a("0fd9"),P=a("8dd9"),S=a("269a"),y=a.n(S),V=a("90a2"),_=Object(d["a"])(o,s,i,!1,null,null,null);t["default"]=_.exports;c()(_,{VBtn:p["a"],VCol:v["a"],VContainer:m["a"],VDivider:h["a"],VIcon:u["a"],VList:g["a"],VListItem:f["a"],VListItemAvatar:x["a"],VListItemContent:b["a"],VListItemSubtitle:b["b"],VListItemTitle:b["c"],VProgressCircular:w["a"],VRow:C["a"],VSheet:P["a"]}),y()(_,{Intersect:V["a"]})}}]);
//# sourceMappingURL=chunk-344deed0.0d1ae95c.js.map