{"version":3,"sources":["webpack:///./node_modules/vuetify-loader/lib/runtime/installDirectives.js","webpack:///./src/views/Servers.vue?2910","webpack:///src/views/Servers.vue","webpack:///./src/views/Servers.vue?1318","webpack:///./src/views/Servers.vue"],"names":["module","exports","component","directives","options","extendOptions","i","render","_vm","this","_h","$createElement","_c","_self","domProps","_s","$t","staticClass","attrs","servers","length","_e","_l","server","index","key","id","name","params","_v","address","node","pagination","page","pageCount","rawName","value","expression","ref","hasScope","isAdmin","staticRenderFns","data","headers","loading","recheckLazy","rowsPerPage","task","watch","loadNextPage","mounted","setInterval","pollServerStatus","beforeDestroy","clearInterval","methods","lazyLoad","isIntersecting","$http","get","limit","ctx","forEach","elem","serverInList","ip","publicHost","port","push","online","nodeAddress","publicPort","Math","ceil","paging","total","response","running","rowSelected","$router","updatePage","newPage","VBtn","VCol","VContainer","VDivider","VIcon","VList","VListItem","VListItemAvatar","VListItemContent","VListItemSubtitle","VListItemTitle","VProgressCircular","VRow","VSheet","Intersect"],"mappings":"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","file":"js/chunk-344deed0-legacy.424311f1.js","sourcesContent":["// IMPORTANT: Do NOT use ES2015 features in this file (except for modules).\n// This module is a runtime utility for cleaner component module output and will\n// be included in the final webpack user bundle.\n\nmodule.exports = function installDirectives (component, directives) {\n  var options = typeof component.exports === 'function'\n    ? component.exports.extendOptions\n    : component.options\n\n  if (typeof component.exports === 'function') {\n    options.directives = component.exports.options.directives\n  }\n\n  options.directives = options.directives || {}\n\n  for (var i in directives) {\n    options.directives[i] = options.directives[i] || directives[i]\n  }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('h1',{domProps:{\"textContent\":_vm._s(_vm.$t('servers.Servers'))}}),_c('v-row',[_c('v-col',[_c('v-sheet',{staticClass:\"mb-8\",attrs:{\"elevation\":\"1\"}},[(_vm.servers.length === 0)?_c('div',{staticClass:\"pt-2 text-center text--disabled\",domProps:{\"textContent\":_vm._s(_vm.$t('servers.NoServers'))}}):_vm._e(),_c('v-list',{attrs:{\"two-line\":\"\"}},_vm._l((_vm.servers),function(server,index){return _c('div',{key:server.id},[_c('v-list-item',{attrs:{\"to\":{ name: 'Server', params: { id: server.id } }}},[_c('v-list-item-avatar',[(server.online)?_c('v-icon',{attrs:{\"color\":\"success\"}},[_vm._v(\" mdi-check-circle \")]):_c('v-icon',{attrs:{\"color\":\"error\"}},[_vm._v(\" mdi-alert-circle \")])],1),_c('v-list-item-content',[_c('v-list-item-title',{domProps:{\"textContent\":_vm._s(server.name)}}),_c('v-list-item-subtitle',{domProps:{\"textContent\":_vm._s(server.address + ' @ ' + server.node)}})],1)],1),(index !== _vm.servers.length - 1)?_c('v-divider'):_vm._e()],1)}),0),(_vm.pagination.page < _vm.pagination.pageCount)?_c('v-row',{directives:[{name:\"intersect\",rawName:\"v-intersect\",value:(_vm.lazyLoad),expression:\"lazyLoad\"}],ref:\"lazy\"},[_c('v-col',{attrs:{\"cols\":\"2\",\"offset\":\"5\"}},[_c('v-progress-circular',{staticClass:\"mr-2\",attrs:{\"indeterminate\":\"\"}}),_c('span',{domProps:{\"textContent\":_vm._s(_vm.$t('common.Loading'))}})],1)],1):_vm._e(),_c('v-btn',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.hasScope('servers.create') || _vm.isAdmin()),expression:\"hasScope('servers.create') || isAdmin()\"}],attrs:{\"color\":\"primary\",\"bottom\":\"\",\"right\":\"\",\"fixed\":\"\",\"fab\":\"\",\"dark\":\"\",\"large\":\"\",\"to\":{name: 'AddServer'}}},[_c('v-icon',[_vm._v(\"mdi-plus\")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container>\n    <h1 v-text=\"$t('servers.Servers')\" />\n    <v-row>\n      <v-col>\n        <v-sheet\n          elevation=\"1\"\n          class=\"mb-8\"\n        >\n          <div\n            v-if=\"servers.length === 0\"\n            class=\"pt-2 text-center text--disabled\"\n            v-text=\"$t('servers.NoServers')\"\n          />\n          <v-list two-line>\n            <div\n              v-for=\"(server, index) in servers\"\n              :key=\"server.id\"\n            >\n              <v-list-item :to=\"{ name: 'Server', params: { id: server.id } }\">\n                <v-list-item-avatar>\n                  <v-icon\n                    v-if=\"server.online\"\n                    color=\"success\"\n                  >\n                    mdi-check-circle\n                  </v-icon>\n                  <v-icon\n                    v-else\n                    color=\"error\"\n                  >\n                    mdi-alert-circle\n                  </v-icon>\n                </v-list-item-avatar>\n                <v-list-item-content>\n                  <v-list-item-title v-text=\"server.name\" />\n                  <v-list-item-subtitle v-text=\"server.address + ' @ ' + server.node\" />\n                </v-list-item-content>\n              </v-list-item>\n              <v-divider v-if=\"index !== servers.length - 1\" />\n            </div>\n          </v-list>\n          <v-row\n            v-if=\"pagination.page < pagination.pageCount\"\n            ref=\"lazy\"\n            v-intersect=\"lazyLoad\"\n          >\n            <v-col\n              cols=\"2\"\n              offset=\"5\"\n            >\n              <v-progress-circular\n                indeterminate\n                class=\"mr-2\"\n              />\n              <span v-text=\"$t('common.Loading')\" />\n            </v-col>\n          </v-row>\n          <v-btn\n            v-show=\"hasScope('servers.create') || isAdmin()\"\n            color=\"primary\"\n            bottom\n            right\n            fixed\n            fab\n            dark\n            large\n            :to=\"{name: 'AddServer'}\"\n          >\n            <v-icon>mdi-plus</v-icon>\n          </v-btn>\n        </v-sheet>\n      </v-col>\n    </v-row>\n  </v-container>\n</template>\n\n<script>\nimport { handleError } from '@/utils/api'\n\nexport default {\n  data () {\n    return {\n      headers: [\n        {\n          text: this.$t('common.Name'),\n          value: 'name',\n          sortable: true\n        },\n        {\n          text: this.$t('nodes.Node'),\n          value: 'node',\n          sortable: true\n        },\n        {\n          text: this.$t('common.Address'),\n          value: 'address',\n          sortable: true\n        },\n        {\n          text: this.$t('common.Online'),\n          value: 'online',\n          sortable: true\n        }\n      ],\n      servers: [],\n      loading: false,\n      recheckLazy: false,\n      pagination: {\n        page: 0,\n        rowsPerPage: 10,\n        pageCount: 1\n      },\n      task: null\n    }\n  },\n  watch: {\n    recheckLazy (newVal) {\n      const rect = /* document.getElementById('lazy') */ this.$refs.lazy.getBoundingClientRect()\n      const viewHeight = Math.max(document.documentElement.clientHeight, window.innerHeight)\n      if (\n        !(rect.bottom < 0 || rect.top - viewHeight >= 0) &&\n        this.pagination.page < this.pagination.pageCount\n      ) {\n        this.loadNextPage()\n      }\n    }\n  },\n  mounted () {\n    this.task = setInterval(this.pollServerStatus, 30 * 1000)\n  },\n  beforeDestroy () {\n    if (this.task != null) {\n      clearInterval(this.task)\n    }\n  },\n  methods: {\n    lazyLoad (entries, observer, isIntersecting) {\n      if (isIntersecting) {\n        this.loadNextPage()\n      }\n    },\n    loadNextPage () {\n      if (this.loading) return\n      this.loading = true\n      const ctx = this\n      const { page, rowsPerPage } = this.pagination\n      this.$http.get('/api/servers', {\n        params: {\n          page: page + 1,\n          limit: rowsPerPage\n        }\n      }).then(response => {\n        for (const i in response.data.servers) {\n          const server = response.data.servers[i]\n\n          let serverInList = false\n\n          ctx.servers.forEach(elem => {\n            if (server.id === elem.id) {\n              serverInList = true\n            }\n          })\n\n          if (!serverInList) {\n            let ip = ''\n\n            if (server.ip && server.ip !== '' && server.ip !== '0.0.0.0') {\n              ip = server.ip\n            } else {\n              ip = server.node.publicHost\n            }\n\n            if (server.port) {\n              ip += ':' + server.port\n            }\n\n            ctx.servers.push({\n              id: server.id,\n              name: server.name,\n              node: server.node.name,\n              address: ip,\n              online: false,\n              nodeAddress: server.node.publicHost + ':' + server.node.publicPort\n            })\n          }\n        }\n        ctx.pagination.page = page + 1\n        const paging = response.data.paging\n        ctx.pagination.pageCount = Math.ceil(paging.total / ctx.pagination.rowsPerPage)\n        ctx.loading = false\n        ctx.recheckLazy = true\n      })\n        .catch(handleError(ctx))\n        .finally(() => {\n          ctx.pollServerStatus()\n        })\n    },\n    pollServerStatus () {\n      for (const i in this.servers) {\n        const server = this.servers[i]\n        this.$http.get('/proxy/daemon/server/' + server.id + '/status').then(response => {\n          if (response.data) {\n            if (response.data.running) {\n              server.online = true\n            } else {\n              server.online = false\n            }\n          }\n        })\n      }\n    },\n    rowSelected (item) {\n      this.$router.push({ name: 'Server', params: { id: item.id } })\n    },\n    updatePage (newPage) {\n      this.pagination.page = newPage\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Servers.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Servers.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Servers.vue?vue&type=template&id=573e4839&\"\nimport script from \"./Servers.vue?vue&type=script&lang=js&\"\nexport * from \"./Servers.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VList } from 'vuetify/lib/components/VList';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemAvatar } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VListItemSubtitle } from 'vuetify/lib/components/VList';\nimport { VListItemTitle } from 'vuetify/lib/components/VList';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSheet } from 'vuetify/lib/components/VSheet';\ninstallComponents(component, {VBtn,VCol,VContainer,VDivider,VIcon,VList,VListItem,VListItemAvatar,VListItemContent,VListItemSubtitle,VListItemTitle,VProgressCircular,VRow,VSheet})\n\n\n/* vuetify-loader */\nimport installDirectives from \"!../../node_modules/vuetify-loader/lib/runtime/installDirectives.js\"\nimport Intersect from 'vuetify/lib/directives/intersect'\ninstallDirectives(component, {Intersect})\n"],"sourceRoot":""}